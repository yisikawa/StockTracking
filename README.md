# 株価トラッキング & 分析アプリ

ネットから株価データを取得し、リアルタイムで追跡・分析評価を行うWebアプリケーションです。

## 機能

- 📊 **株価データの取得**: Yahoo Finance APIを使用してリアルタイムの株価データを取得
- 📈 **複数銘柄の追跡**: 複数の銘柄を同時に追跡・管理
- 📉 **チャート表示**: 期間を選択して株価チャートを表示
- 🔍 **詳細分析**: RSI、移動平均、ボラティリティなどの技術指標を計算
- 💯 **評価スコア**: 総合的な評価スコア（0-100）と推奨アクションを提供
- 💾 **データ保存**: SQLiteデータベースに株価履歴を保存

## セットアップ

### 1. 必要な環境

- Python 3.8以上
- pip（Pythonパッケージマネージャー）
- Yahooアカウント（オプション、レート制限回避のため推奨）

### 2. インストール

```bash
# プロジェクトディレクトリに移動
cd StockTracking

# 依存パッケージをインストール
pip install -r requirements.txt
```

### 3. コンフィグファイルの設定

アプリケーションの設定は`config.json`ファイルで管理します。

```bash
# サンプルコンフィグファイルをコピー
cp config.json.example config.json

# config.jsonファイルを編集して設定を変更
```

#### 主要な設定項目

- **database**: データベース名
- **cache**: キャッシュ設定（有効期限、履歴日数）
- **api**: API設定（リトライ回数、待機時間）
- **analysis**: 分析設定（RSI期間、移動平均期間など）
- **yahoo_auth**: Yahoo認証設定
- **server**: サーバー設定（ホスト、ポート、デバッグモード）

#### Yahoo認証の設定（オプション）

レート制限を回避するため、Yahooアカウントでの認証を推奨します。

1. ブラウザでYahoo Finance（https://finance.yahoo.com）にログイン
2. 開発者ツール（F12）を開く
3. Networkタブでリクエストを確認し、Cookieを取得
4. `config.json`ファイルの`yahoo_auth`セクションを編集：

```json
{
  "yahoo_auth": {
    "enabled": true,
    "cookie": "your_cookie_string_here",
    "username": "",
    "password": ""
  }
}
```

**注意**: 
- 認証情報を設定しない場合（`enabled: false`）、匿名アクセスとして動作しますが、レート制限が厳しくなる可能性があります
- `config.json`ファイルは`.gitignore`に含まれているため、Gitにコミットされません

### 4. アプリケーションの起動

```bash
# バックエンドサーバーを起動
python app.py
```

サーバーが起動したら、ブラウザで `http://localhost:5000` にアクセスしてください。

**注意**: `index.html`を直接開くのではなく、Flaskサーバー経由でアクセスする必要があります。または、`index.html`を直接開く場合は、CORSの問題を回避するためにブラウザのセキュリティ設定を調整する必要があります。

## 使用方法

1. **銘柄の追加**: 上部のフォームに銘柄コード（例: AAPL, MSFT, GOOGL）を入力して「銘柄を追加」をクリック
2. **ダッシュボード**: 追加した銘柄の現在の価格と変動がカード形式で表示されます
3. **詳細表示**: カードをクリックすると、詳細な情報、チャート、分析結果が表示されます
4. **期間選択**: 詳細画面で期間（1ヶ月、3ヶ月、6ヶ月、1年、2年）を選択できます
5. **銘柄の削除**: 各カードの「削除」ボタンで銘柄を削除できます

## 分析指標

アプリケーションは以下の指標を使用して株価を分析します：

- **移動平均（MA）**: 20日と50日の移動平均
- **RSI（相対力指数）**: 14日間のRSI
- **ボラティリティ**: 年率換算の価格変動率
- **価格位置**: 過去の最高値・最低値に対する現在価格の位置
- **評価スコア**: 複数の指標を総合した0-100のスコア

## 技術スタック

- **バックエンド**: Flask (Python)
- **フロントエンド**: HTML, CSS, JavaScript
- **データベース**: SQLite
- **株価API**: yfinance (Yahoo Finance)
- **チャート**: Chart.js

## キャッシュ機能

レート制限を回避するため、以下のキャッシュ機能を実装しています：

- **価格キャッシュ**: 最新の価格情報を5分間キャッシュ
- **履歴データ**: データベースに保存された履歴データを優先的に使用
- **自動フォールバック**: APIエラー時にキャッシュデータを自動的に使用
- **リクエスト間隔制御**: ダッシュボードでのリクエスト間に待機時間を設定

キャッシュされたデータを使用している場合、UIに「(キャッシュ)」の表示が表示されます。

## 注意事項

- このアプリケーションは教育・個人利用を目的としています
- 投資判断は自己責任で行ってください
- Yahoo Finance APIの利用規約に従って使用してください
- リアルタイムデータの取得にはインターネット接続が必要です
- APIレート制限に達した場合、キャッシュされたデータが使用されます

## トラブルシューティング

### サーバーが起動しない場合

- Pythonのバージョンを確認: `python --version`
- 依存パッケージが正しくインストールされているか確認: `pip list`

### データが取得できない場合

- インターネット接続を確認
- 銘柄コードが正しいか確認（例: 日本株の場合は `.T` を付ける必要がある場合があります）
- Yahoo Finance APIの利用制限に達していないか確認

### CORSエラーが発生する場合

- Flaskサーバー経由でアクセスしているか確認
- `flask-cors`が正しくインストールされているか確認

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。
